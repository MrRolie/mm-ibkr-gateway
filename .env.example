# =============================================================================
# SAFETY SETTINGS (CRITICAL - READ AND UNDERSTAND BEFORE CHANGING)
# =============================================================================
# This system is SAFE BY DEFAULT. Orders are DISABLED until you explicitly
# enable them. Paper trading mode is the default.
#
# DO NOT change these settings unless you fully understand the implications.
# =============================================================================

# Trading mode: paper = simulated, live = REAL MONEY
# Default: paper (RECOMMENDED)
TRADING_MODE=paper

# Order placement: false = disabled, true = ENABLED (DANGEROUS in live mode)
# Default: false (RECOMMENDED)
ORDERS_ENABLED=false

# Live trading override (required for live trading with orders enabled)
# Create this file ONLY after reading all safety documentation
# Example: C:\ProgramData\mm-ibkr-gateway\live_trading_confirmed.txt
LIVE_TRADING_OVERRIDE_FILE=

# =============================================================================
# API SERVER SETTINGS
# =============================================================================

API_PORT=8000

# API bind host - set to LAN IP for remote access (e.g., from Raspberry Pi)
# Default: 127.0.0.1 (localhost only)
# Example: 192.168.1.100 (specific LAN IP)
API_BIND_HOST=127.0.0.1

# Allowed remote IPs/CIDR for inbound connections (comma-separated)
# Example: 192.168.1.50,192.168.1.0/24
ALLOWED_IPS=127.0.0.1

# API authentication key (generate with generate-api-key.ps1)
# Leave unset to disable authentication (NOT RECOMMENDED for LAN deployment)
# API_KEY=your-secret-key

# Request timeout in seconds (default: 30.0)
API_REQUEST_TIMEOUT=30.0

# =============================================================================
# IBKR GATEWAY CONNECTION SETTINGS
# =============================================================================

# IBKR Gateway / TWS Connection
IBKR_GATEWAY_HOST=127.0.0.1

# Paper Trading Connection (default: port 4002, client_id 1)
PAPER_GATEWAY_PORT=4002
PAPER_CLIENT_ID=1

# Live Trading Connection (default: port 4001, client_id 777)
LIVE_GATEWAY_PORT=4001
LIVE_CLIENT_ID=777

# =============================================================================
# GATEWAY BEHAVIOR SETTINGS
# =============================================================================

# Gateway window visibility (true = visible UI; false = minimized/headless)
# Note: Set to false for headless service operation
GATEWAY_SHOW_WINDOW=false

# Enable/disable IBAutomater Java agent for UI automation (auto-login)
IB_AUTOMATER_ENABLED=true

# =============================================================================
# LOGGING SETTINGS
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL (default: INFO)
LOG_LEVEL=INFO

# Log format: json or text (default: json)
# json = structured JSON logs with correlation IDs
# text = human-readable text logs (for development)
LOG_FORMAT=json

# Log directory
# LOG_DIR=C:\ProgramData\mm-ibkr-gateway\storage\logs

# =============================================================================
# STORAGE PATHS
# =============================================================================

# Base storage directory (ProgramData recommended for services)
# DATA_STORAGE_DIR=C:\ProgramData\mm-ibkr-gateway\storage

# Audit database path (default: {DATA_STORAGE_DIR}/audit.db)
# AUDIT_DB_PATH=C:\ProgramData\mm-ibkr-gateway\storage\audit.db

# IBKR Gateway installation path
# IBKR_GATEWAY_PATH=C:\Jts\ibgateway\1042

# =============================================================================
# MM-CONTROL SETTINGS
# =============================================================================

# Base directory for mm-control artifacts (guard file, toggles, audit log)
# MM_CONTROL_BASE_DIR=C:\ProgramData\mm-control

# Admin API token for /admin/* endpoints (REQUIRED for admin operations)
# Generate a secure random token and set here.
# If not set, admin endpoints return 403 (fail-closed design).
# ADMIN_TOKEN=your-admin-secret-token

# Enable background TTL monitor in API (monitors toggle TTL expiry)
# Default: true (recommended for automatic TTL revert)
MM_CONTROL_ENABLE_BACKGROUND_MONITOR=true

# TTL check interval in seconds (if background monitor enabled)
# Default: 30 seconds
MM_CONTROL_TTL_CHECK_INTERVAL=30

# =============================================================================
# DEVELOPMENT / ADVANCED SETTINGS (Time-windowed operation)
# =============================================================================

# API will return 503 Service Unavailable outside this window.
# Services are managed by NSSM and run 24/7; window enforcement is internal to API.
# Format: HH:MM (24-hour)
RUN_WINDOW_START=04:00
RUN_WINDOW_END=20:00

# Active days (comma-separated abbreviations)
RUN_WINDOW_DAYS=Mon,Tue,Wed,Thu,Fri

# Timezone for schedule calculations
RUN_WINDOW_TIMEZONE=America/Toronto
